<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: sans-serif; background: #111; color: #fff; text-align: center; margin: 0; padding: 10px; }
        .container { display: flex; flex-direction: column; align-items: center; }
        
        .bar-container { width: 90%; background: #333; height: 15px; margin: 4px; border-radius: 10px; overflow: hidden; }
        .bar { height: 100%; width: 0%; transition: width 0.05s; }
        .raw { background: #ff3b30; } /* Red for raw/noisy */
        .filtered { background: #34c759; } /* Green for clean */
        
        .label { font-size: 0.8rem; margin-top: 10px; color: #aaa; text-transform: uppercase; }
        button { padding: 20px; font-size: 1.2rem; background: #007AFF; color: white; border: none; border-radius: 10px; margin-top: 50px; }
        h3 { margin-bottom: 5px; font-size: 1rem; }
    </style>
</head>
<body>

    <div id="setup">
        <button id="start">Start Comparison</button>
    </div>

    <div id="viz" style="display:none;" class="container">
        <h3>1. Raw Sensor Data (Noisy)</h3>
        <div class="label">X Accel</div>
        <div class="bar-container"><div id="raw-x" class="bar raw"></div></div>
        <div class="label">Y Accel</div>
        <div class="bar-container"><div id="raw-y" class="bar raw"></div></div>

        <hr style="width:100%; border: 0; border-top: 1px solid #444; margin: 20px 0;">

        <h3>2. With Deadzone (Game Ready)</h3>
        <p style="font-size: 0.8rem; color: #888;">Ignores values below 0.5 m/sÂ²</p>
        <div class="label">X Accel</div>
        <div class="bar-container"><div id="dead-x" class="bar filtered"></div></div>
        <div class="label">Y Accel</div>
        <div class="bar-container"><div id="dead-y" class="bar filtered"></div></div>
    </div>

    <script>
        const btn = document.getElementById('start');
        const DEADZONE_THRESHOLD = 0.5; // Anything less than this is ignored

        btn.onclick = async () => {
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                const res = await DeviceMotionEvent.requestPermission();
                if (res === 'granted') start();
            } else { start(); }
        };

        function start() {
            document.getElementById('setup').style.display = 'none';
            document.getElementById('viz').style.display = 'flex';

            window.addEventListener('devicemotion', (e) => {
                const x = e.acceleration.x || 0;
                const y = e.acceleration.y || 0;

                // Update Raw Bars
                updateBar('raw-x', x);
                updateBar('raw-y', y);

                // Update Deadzone Bars
                // If the absolute value is less than threshold, we treat it as ZERO
                const deadX = Math.abs(x) < DEADZONE_THRESHOLD ? 0 : x;
                const deadY = Math.abs(y) < DEADZONE_THRESHOLD ? 0 : y;
                
                updateBar('dead-x', deadX);
                updateBar('dead-y', deadY);
            });
        }

        function updateBar(id, val) {
            // Scale value for visual impact (0 to 100%)
            const width = Math.min(Math.abs(val) * 10, 100); 
            document.getElementById(id).style.width = width + "%";
        }
    </script>
</body>
</html>
