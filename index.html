<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: sans-serif; background: #111; color: #fff; text-align: center; margin: 0; padding: 10px; }
.container { display: flex; flex-direction: column; align-items: center; width:100%; }

.bar-container { width: 90%; background: #333; height: 15px; margin: 4px; border-radius: 10px; overflow: hidden; }
.bar { height: 100%; width: 0%; transition: width 0.05s; }
.raw { background: #ff3b30; }
.filtered { background: #34c759; }
.rotation { background: #5ac8fa; }

.label { font-size: 0.8rem; margin-top: 12px; color: #aaa; text-transform: uppercase; }
.value { font-size: 0.75rem; color: #ccc; margin-bottom: 4px; }

button { padding: 20px; font-size: 1.2rem; background: #007AFF; color: white; border: none; border-radius: 10px; margin-top: 50px; }
h3 { margin-bottom: 5px; font-size: 1rem; }
hr { width:100%; border:0; border-top:1px solid #444; margin:20px 0; }
</style>
</head>
<body>

<div id="setup">
<button id="start">Start Sensors</button>
</div>

<div id="viz" style="display:none;" class="container">

<h3>1. Linear Acceleration (No Gravity)</h3>
<div class="label">X</div><div class="value" id="val-ax"></div><div class="bar-container"><div id="raw-ax" class="bar raw"></div></div>
<div class="label">Y</div><div class="value" id="val-ay"></div><div class="bar-container"><div id="raw-ay" class="bar raw"></div></div>
<div class="label">Z</div><div class="value" id="val-az"></div><div class="bar-container"><div id="raw-az" class="bar raw"></div></div>

<hr>

<h3>2. Acceleration Including Gravity</h3>
<div class="label">X</div><div class="value" id="val-gx"></div><div class="bar-container"><div id="raw-gx" class="bar raw"></div></div>
<div class="label">Y</div><div class="value" id="val-gy"></div><div class="bar-container"><div id="raw-gy" class="bar raw"></div></div>
<div class="label">Z</div><div class="value" id="val-gz"></div><div class="bar-container"><div id="raw-gz" class="bar raw"></div></div>

<hr>

<h3>3. Rotation Rate (Gyroscope)</h3>
<p style="font-size:0.8rem;color:#888;">Degrees per second</p>
<div class="label">Alpha (Z axis)</div><div class="value" id="val-ra"></div><div class="bar-container"><div id="rot-a" class="bar rotation"></div></div>
<div class="label">Beta (X axis)</div><div class="value" id="val-rb"></div><div class="bar-container"><div id="rot-b" class="bar rotation"></div></div>
<div class="label">Gamma (Y axis)</div><div class="value" id="val-rg"></div><div class="bar-container"><div id="rot-g" class="bar rotation"></div></div>

</div>

<script>
const btn = document.getElementById('start');

btn.onclick = async () => {
    if (typeof DeviceMotionEvent.requestPermission === 'function') {
        const res = await DeviceMotionEvent.requestPermission();
        if (res === 'granted') start();
    } else { start(); }
};

function start() {
    document.getElementById('setup').style.display = 'none';
    document.getElementById('viz').style.display = 'flex';

    window.addEventListener('devicemotion', (e) => {

        const ax = e.acceleration?.x || 0;
        const ay = e.acceleration?.y || 0;
        const az = e.acceleration?.z || 0;

        const gx = e.accelerationIncludingGravity?.x || 0;
        const gy = e.accelerationIncludingGravity?.y || 0;
        const gz = e.accelerationIncludingGravity?.z || 0;

        const ra = e.rotationRate?.alpha || 0;
        const rb = e.rotationRate?.beta || 0;
        const rg = e.rotationRate?.gamma || 0;

        update('raw-ax', 'val-ax', ax, 10, "m/s²");
        update('raw-ay', 'val-ay', ay, 10, "m/s²");
        update('raw-az', 'val-az', az, 10, "m/s²");

        update('raw-gx', 'val-gx', gx, 10, "m/s²");
        update('raw-gy', 'val-gy', gy, 10, "m/s²");
        update('raw-gz', 'val-gz', gz, 10, "m/s²");

        update('rot-a', 'val-ra', ra, 0.5, "°/s");
        update('rot-b', 'val-rb', rb, 0.5, "°/s");
        update('rot-g', 'val-rg', rg, 0.5, "°/s");
    });
}

function update(barId, valueId, val, scale, unit) {
    const width = Math.min(Math.abs(val) * scale, 100);
    document.getElementById(barId).style.width = width + "%";
    document.getElementById(valueId).innerText = val.toFixed(3) + " " + unit;
}
</script>

</body>
</html>
